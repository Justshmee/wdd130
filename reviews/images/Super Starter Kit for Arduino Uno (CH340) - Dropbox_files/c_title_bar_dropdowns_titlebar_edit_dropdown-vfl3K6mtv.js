define(["require","exports","react","./c_file_viewer_collection_viewer","./e_folder_viewer_src_main","./c_ui-icon_line_zoom-out","./c_flux_store_listener","./c_init_data_runtime","./c_files_view_data_store","./c_ui-icon_line_zip","./c_file_viewer_components_titlebar_menu_content","./c_core_uri","./c_react_query_helpers_helpers","./c_api_v2_client_base","./c_core_attribution_header","./c_csrf","metaserver/static/js/modules/constants/viewer","./c_api_v2_noauth_client","./c_core_i18n","./e_core_exception","./c_lodash-es_lodash","./c_src_sink_index","./c_apex-metrics_src_types","metaserver/static/js/langpack","./c_growth_ui_api","./c_esm_misc_util","./c_pap-events_navigation_navigate_to_replay","./c_base64","./c_browse_models","./c_hooks_use_stabilized_callback","./c_stormcrow_gating_factory","./c_stormcrow_types_log_exposure","metaserver/static/js/modules/constants/pdf_editing","./c_ui-icon_line_restore","./c_growth_ui_teams_web_actions_logger_events","metaserver/static/js/modules/constants/search","./c_toolkit_dist_redux-toolkit","./c_home_store","./c_plugin_utils_getImageDefaultSizes","metaserver/static/js/modules/constants/web_experience_constants","metaserver/static/js/modules/constants/unity","./c_core_notify","react-dom","./e_edison","./c_init_data_edison","./c_referrer_cleansing_redirect","./c_cloud_docs_types","./c_keymaster","./c_es_hooks_useDispatch","./c_core_utils_browser_detection","./c_campaigns_campaign_enums","./c_bolt_metaserver_clients","./c_skeleton_index","./c_ui-icon_line_team","./c_stormcrow_explicit_exposure_logging","./c_core_xhr","metaserver/static/js/modules/constants/sharing","metaserver/static/js/modules/constants/locales","metaserver/static/js/modules/constants/file_viewer_configuration","metaserver/static/js/modules/constants/file_viewer_feature_experiments","metaserver/static/js/modules/constants/time","metaserver/static/js/modules/constants/login_and_register","metaserver/static/js/modules/constants/fingerprintjs_constants","./c_security_crypto","./c_flows_logging_flows_loggers","./c_spectrum_util_raf_throttle","./c_flux_base_store","./c_cloud_docs_constants","./c_chips_index","./c_chip_index","metaserver/static/js/modules/constants/contacts","./c_spectrum_colorized_icon","./c_spectrum_svg_icon_bundle","./c_spectrum_positioned_portal","./c_user_centric_perf_metrics_component_visually_complete_component_visually_complete_calculator","./c_plugin_utils_drawWatermarkOnCanvas","./c_resize-observer-polyfill_dist_ResizeObserver","./c_badges_index","./c_badge_index","./c_react-error-boundary"],(function(e,i,t,n,o,c,r,s,a,l,d,_,u,p,g,A,v,f,b,y,m,w,T,O,C,h,E,U,S,L,P,M,x,I,k,R,F,V,j,D,H,N,z,G,B,q,W,K,Q,Z,J,X,Y,$,ee,ie,te,ne,oe,ce,re,se,ae,le,de,_e,ue,pe,ge,Ae,ve,fe,be,ye,me,we,Te,Oe,Ce,he){"use strict";function Ee(e){if(e&&e.__esModule)return e;var i=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(i,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}})),i.default=e,Object.freeze(i)}var Ue=Ee(t);const Se=o.defineMessage({id:"1wQEUl",defaultMessage:"Rotate right"}),Le=o.defineMessage({id:"2BgLiN",defaultMessage:"Rotate left"}),Pe=o.defineMessage({id:"tupnL9",defaultMessage:"Crop"}),Me=o.defineMessage({id:"VghM9c",defaultMessage:"Flip"}),xe=o.defineMessage({id:"nUBVPc",defaultMessage:"Adjust"}),Ie=(e,i,t,c)=>{const r=i&&"ON"===(null==c?void 0:c.previews_exp_ungate_image_edit);return!i||r?e:(e=>{const{action:i,encryptionOptions:t}=e;return n.loggedOutSUSIAndActionContinuationHandler(i,o.PreviewType.Image,t)})(t)},ke=n.withActionCondition(n.imageEditingActionCondition,((e,i,t,r,s)=>((e,i,t,r,s)=>[{icon:c.ShapeRotateLeftLine,label:Le,userAction:o.UserAction.RotateLeft,disabled:{disabled:!1},action:{type:"click",handler:Ie(n.onRotate(n.RotationDirection.LEFT,e,i,o.UserActionContext.EditMenu),r,{action:{action:"edit",initialAction:"rotateLeft"},encryptionOptions:s},t)}},{icon:c.ShapeRotateRightLine,label:Se,userAction:o.UserAction.RotateRight,disabled:{disabled:!1},action:{type:"click",handler:Ie(n.onRotate(n.RotationDirection.RIGHT,e,i,o.UserActionContext.EditMenu),r,{action:{action:"edit",initialAction:"rotateRight"},encryptionOptions:s},t)}},{icon:c.FlipHorizontalLine,label:Me,userAction:o.UserAction.FlipHorizontal,disabled:{disabled:!1},action:{type:"click",handler:Ie(n.onFlip(e,i,o.UserActionContext.EditMenu),r,{action:{action:"edit",initialAction:"flip"},encryptionOptions:s},t)}},{icon:c.CropLine,label:Pe,userAction:o.UserAction.Crop,disabled:{disabled:!1},action:{type:"click",handler:Ie(n.onCrop(e,i,o.UserActionContext.EditMenu),r,{action:{action:"edit",initialAction:"crop"},encryptionOptions:s},t)}},{icon:c.SliderLine,label:xe,userAction:o.UserAction.Adjust,disabled:{disabled:!1},action:{type:"click",handler:Ie(n.onAdjust(e,i,o.UserActionContext.EditMenu),r,{action:{action:"edit",initialAction:"adjust"},encryptionOptions:s},t)}}])(i,t,r,!e.user,s)),[]),Re=n.withActionCondition(n.selfSignActionCondition,((i,t,c,r,s,a)=>{if(s||a)return;const l=n.getSelfSignActionArgs(t,c,i.user,i.file,r,o.UserActionContext.EditMenu);return{label:n.SELF_SIGN_ACTION_STRING,icon:o.SignatureLine,userAction:o.UserAction.SelfSign,disabled:{disabled:!1},action:{type:"click",handler:()=>new Promise((function(i,t){e(["./c_action_plugins_self_sign_action_action"],i,t)})).then((({selfSignAction:e})=>e(l)))}}}),void 0),Fe=n.withActionCondition(n.sendForSignatureActionCondition,((i,t,c,s,a,l)=>{if(a||l)return;const d=n.getActionArgs(c,t,i.user,i.file,s);return{label:n.SEND_FOR_SIGNATURE_ACTION_STRING,icon:r.SendLine,userAction:o.UserAction.SendForSignature,disabled:{disabled:!1},action:{type:"click",handler:()=>new Promise((function(i,t){e(["./c_action_plugins_send_for_signature_action_action"],i,t)})).then((({sendForSignatureAction:e})=>e(d)))}}}),void 0),Ve=(e,i,t)=>{if(!i)return e;const{action:o,encryptionOptions:c,previewType:r}=t;return n.loggedOutSUSIAndActionContinuationHandler(o,r,c)},je=({loggedOut:e,encryptionOptions:i,previewType:t})=>({icon:c.CutLine,label:n.loggedOutEditButtonText,userAction:o.UserAction.VideoEdit,disabled:{disabled:!1},action:{type:"click",handler:Ve((()=>s.__awaiter(void 0,void 0,void 0,(function*(){}))),e,{action:{action:"edit"},encryptionOptions:i,previewType:t})}}),De=({logUserAction:e,setActiveEditorCallback:i,loggedOut:t,encryptionOptions:r})=>[{icon:c.ShapeRotateLeftLine,label:n.ROTATE_LEFT_TOOLTIP,userAction:o.UserAction.RotateLeft,disabled:{disabled:!1},action:{type:"click",handler:Ve(n.rotateLeftHandler(e,i,o.UserActionContext.EditMenu),t,{action:{action:"edit",initialAction:"rotateLeft"},encryptionOptions:r,previewType:o.PreviewType.Video})}},{icon:c.ShapeRotateRightLine,label:n.ROTATE_RIGHT_TOOLTIP,userAction:o.UserAction.RotateRight,disabled:{disabled:!1},action:{type:"click",handler:Ve(n.rotateRightHandler(e,i,o.UserActionContext.EditMenu),t,{action:{action:"edit",initialAction:"rotateRight"},encryptionOptions:r,previewType:o.PreviewType.Video})}}],He=({logUserAction:e,setActiveEditorCallback:i,loggedOut:t,encryptionOptions:r})=>[{icon:c.FlipHorizontalLine,label:n.FLIP_HORIZONTAL_LABEL,userAction:o.UserAction.FlipHorizontal,disabled:{disabled:!1},action:{type:"click",handler:Ve(n.flipHorizontalHandler(e,i,o.UserActionContext.EditMenu),t,{action:{action:"edit",initialAction:"flipHorizontal"},encryptionOptions:r,previewType:o.PreviewType.Video})}},{icon:c.FlipVerticalLine,label:n.FLIP_VERTICAL_LABEL,userAction:o.UserAction.FlipVertical,disabled:{disabled:!1},action:{type:"click",handler:Ve(n.flipVerticalHandler(e,i,o.UserActionContext.EditMenu),t,{action:{action:"edit",initialAction:"flipVertical"},encryptionOptions:r,previewType:o.PreviewType.Video})}}],Ne=({logUserAction:e,setActiveEditorCallback:i,encryptionOptions:t,loggedOut:r})=>({icon:c.CropLine,label:n.CROP_TOOLTIP,disabled:{disabled:!1},userAction:o.UserAction.Crop,action:{type:"click",handler:Ve(n.cropHandler(e,i,o.UserActionContext.EditMenu),r,{action:{action:"edit",initialAction:"crop"},encryptionOptions:t,previewType:o.PreviewType.Video})}}),ze=({logUserAction:e,setActiveEditorCallback:i,loggedOut:t,encryptionOptions:r,previewType:s})=>({icon:c.CutLine,label:n.TRIM_TOOLTIP,userAction:o.UserAction.Trim,disabled:{disabled:!1},action:{type:"click",handler:Ve(n.trimHandler(e,i,o.UserActionContext.EditMenu),t,{action:{action:"edit",initialAction:"trim"},encryptionOptions:r,previewType:s})}}),Ge=(e,i,t,c,r)=>{if(!(n.isLoggedOutVideoEditEnabled(c,e.previewType)&&n.getActionCondition(e,n.audioVideoEditingLoggedOutActionCondition)||n.getActionCondition(e,n.audioVideoEditingActionCondition)))return[];const s=e.previewType===o.PreviewType.Video,a="ON"===c.previews_exp_audio_trimming_str&&e.previewType===o.PreviewType.Audio;return s?Be(i,t,c,!e.user,r):a?qe(i,t,c,!e.user,r):[]},Be=(e,i,t,n,c)=>{const r={logUserAction:e,setActiveEditorCallback:i,loggedOut:n,encryptionOptions:c,previewType:o.PreviewType.Video};return r.loggedOut&&"V1"===t.previews_exp_logged_out_audio_video_editing?[je(r)]:[ze(r),Ne(r),...De(r),...He(r)]},qe=(e,i,t,n,c)=>{const r={logUserAction:e,setActiveEditorCallback:i,loggedOut:n,encryptionOptions:c,previewType:o.PreviewType.Video};return r.loggedOut&&"V1"===t.previews_exp_logged_out_audio_video_editing?[je(r)]:[ze(r)]},We=n.withActionCondition(n.pdfEditActionCondition,((i,t,r,s,a,d)=>{const _="ON"===r.previews_exp_ungate_pdf_edit;return i.user||_?[{label:n.EDIT_PDF_ACTION_STRING,icon:l.EditLine,userAction:o.UserAction.EditPdf,disabled:{disabled:!1},action:{type:"click",handler:()=>new Promise((function(i,t){e(["./c_action_plugins_pdf_edit_action_action"],i,t)})).then((({pdfEditAction:e})=>e({setActiveEditorCallback:s,logUserAction:t,getCurrentPage:a},o.UserActionContext.EditMenu)))}}]:[{icon:l.EditLine,label:n.EDIT_PDF_ACTION_STRING,userAction:o.UserAction.EditPdf,disabled:{disabled:!1},action:{type:"click",handler:n.loggedOutSUSIAndActionContinuationHandler({action:"edit"},o.PreviewType.SsrDoc,d)}},{icon:c.ScribbleLine,userAction:o.UserAction.Draw,disabled:{disabled:!1},label:o.defineMessage({id:"7E2+UP",defaultMessage:"Draw"}),action:{type:"click",handler:n.loggedOutSUSIAndActionContinuationHandler({action:"edit"},o.PreviewType.SsrDoc,d)}},{icon:c.HighlightLine,userAction:o.UserAction.Highlight,disabled:{disabled:!1},label:o.defineMessage({id:"e7+jFI",defaultMessage:"Highlight"}),action:{type:"click",handler:n.loggedOutSUSIAndActionContinuationHandler({action:"edit"},o.PreviewType.SsrDoc,d)}},{icon:c.TextBoxLine,userAction:o.UserAction.AddText,disabled:{disabled:!1},label:o.defineMessage({id:"B1Oo3m",defaultMessage:"Add text"}),action:{type:"click",handler:n.loggedOutSUSIAndActionContinuationHandler({action:"edit"},o.PreviewType.SsrDoc,d)}}]}),[]),Ke=n.withActionCondition(n.watermarkActionCondition,((e,i)=>({label:o.defineMessage({id:"MqyPTe",defaultMessage:"Watermark"}),userAction:o.UserAction.Watermark,disabled:{disabled:!1},icon:l.StampLine,action:{type:"click",handler:()=>s.__awaiter(void 0,void 0,void 0,(function*(){return i(n.WATERMARKING_PLUGIN_ID,o.UserActionContext.EditMenu)}))}})),void 0);i.default=({contentProps:e,setMenuDisabled:i})=>{var t;const c=o.useIntl(),{pluginArgs:r,previewSurface:s}=n.usePluginMigrationContext(),{pluginContext:l,featureConfig:_,fileViewerId:u,logUserAction:p}=a.useFileViewerContext(),g=n.useFileViewerSelector(n.getCurrentPreviewKey,u),A=null!==(t=n.useCurrentPreviewMetadata().previewType)&&void 0!==t?t:o.PreviewType.Loading,v=r.getActiveFile().file,f=r.getActiveFile().sharePermission,b=n.useCurrentPageCount(),y=n.useSetActiveEditorCallback(),m=n.useFileViewerSelector(n.getCurrentFilePreviewUI,u),w=n.useStabilizedCallback((()=>{var e;return null===(e=n.filterDocFilePreviewUiState(m))||void 0===e?void 0:e.currentPageIndex})),{encryptionOptions:T,userHasDmtConflict:O,shouldDisableFeaturesIfTeamSuspended:C,user:h}=r,E=Ue.useMemo((()=>({file:v,user:h,previewSurface:s,previewType:A,sharePermission:f,previewKey:g})),[v,h,s,A,f,g]),U=Ue.useMemo((()=>[[...We(E,p,_,y,w,T),...ke(E,y,p,_,T),...Ge(E,p,y,_,T)],[Ke(E,y),Re(E,p,y,b,O,C),Fe(E,p,y,b,O,C)]]),[E,p,_,y,w,T,b,O,C]),S=n.useRootFile(),L=n.useAudioVideoEditDisabledTooltipMsg(null==S?void 0:S.name,null==S?void 0:S.size),P=A===o.PreviewType.Image||n.isLoggedOutVideoEditEnabled(l.sdkConfig,A)||A===o.PreviewType.SsrDoc;let M;const x=U.every((e=>e.every((e=>!e))));L?M=L:n.isDownloadPluginEnabled(v,f)?r.user||P?x&&(M=c.formatMessage({id:"qURjdV",defaultMessage:"Not available for this file"})):M=c.formatMessage({id:"8QvtQB",defaultMessage:"Log in or sign up to edit"}):M=c.formatMessage(n.DISABLED_FOR_THIS_FILE_TOOLTIP_STRING),Ue.useEffect((()=>{i({disabled:!!M,tooltip:M})}),[i,U,M]);const I=Ue.useCallback((e=>p(e,o.UserActionContext.EditMenu)),[p]);return Ue.createElement(d.TitlebarMenuContent,{contentProps:e,elementId:"edit-menu",options:U,logAction:I})}}));
//# sourceMappingURL=c_title_bar_dropdowns_titlebar_edit_dropdown.js-vflCaU7Ee.map
