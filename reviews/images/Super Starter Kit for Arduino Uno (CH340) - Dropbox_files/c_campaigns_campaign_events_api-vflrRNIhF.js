define(["exports","./c_init_data_runtime","react","./e_core_exception","./c_react_query_helpers_helpers","./e_folder_viewer_src_main"],(function(e,n,t,i,r,a){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function c({err:e,severity:n=i.SEVERITY.NONCRITICAL,exc_extra:t={}}){i.reportException({err:e,tags:["megaphone","robe"],severity:n,exc_extra:t})}function _(e,n,t){const i=new r.UserApiV2Client,a={megaphone_impression_id:e.campaignImpressionId,megaphone_request_context:{user_id:e.userId},campaign_event_name:n,campaign_event_info:t,campaign_id:o(e.campaignId),version_id:o(e.campaignVariantId)};return function(e){return e.ns("megaphone")}(i).rpc("log_campaign_event",a,{subjectUserId:e.userId}).catch((t=>{c({err:t,exc_extra:{user_id:e.userId,impression_id:e.campaignImpressionId,event_name:n[".tag"]}})}))}function o(e){switch(typeof e){case"string":return parseInt(e,10);case"number":return e;default:return}}s(t).default.createContext(void 0),e.createMegaphoneCampaignImpressionContext=function(e,n,t){let i;try{i={campaignId:n,campaignVariantId:t,campaignImpressionId:e,userId:r.mustGetActiveUserId()}}catch(e){c({err:e})}return i},e.logCampaignClick=function(e,n){return _(e,{".tag":"click"},{cta_id:n})},e.logCampaignDismissed=function(e){return _(e,{".tag":"dismissed"})},e.logCampaignImpression=function(e){return _(e,{".tag":"impression"})},e.setCampaignDismissedInUserMetadata=function(e,t,i){return n.__awaiter(this,void 0,void 0,(function*(){if(e)try{const{CAMPAIGNS_TOOLKIT_USER_DISMISSED_CAMPAIGNS:n}=yield a.getUserMetadata(["CAMPAIGNS_TOOLKIT_USER_DISMISSED_CAMPAIGNS"],i),t=new Set(n?n.split(":"):"").add(`${e}`),r=Array.from(t).join(":");yield a.setUserMetadata({CAMPAIGNS_TOOLKIT_USER_DISMISSED_CAMPAIGNS:r},i)}catch(n){c({err:n,exc_extra:{user_id:i,impression_id:t,campaign_id:e,event_name:"setCampaignDismissedInUserMetadata"}})}}))}}));
//# sourceMappingURL=c_campaigns_campaign_events_api.js-vflwZ-JwT.map
