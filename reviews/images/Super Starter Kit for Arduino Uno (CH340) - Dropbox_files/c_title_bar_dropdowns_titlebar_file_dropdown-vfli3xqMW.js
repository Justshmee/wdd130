define(["require","exports","react","./c_file_viewer_collection_viewer","./e_folder_viewer_src_main","./c_ui-icon_sync_issue","./c_core_i18n","./c_init_data_runtime","./c_conversions_actions_unzip","./c_flows_utils_browse_logger","./c_flows_redux_reducer","./c_flows_logging_flows_loggers","./c_flows_redux_store","./c_flows_redux_actions","./c_growth_ui_api","./c_comments2_hooks_continuous_annotation_hook","./c_spectrum_util_raf_throttle","./c_ux_analytics_modal_tracking","./c_spectrum_svg_icon_bundle","./c_cloud_docs_types","./c_react_query_helpers_helpers","./c_hooks_use_stabilized_callback","./c_api_v2_client_base","./c_cloud_docs_constants","./c_flux_store_listener","./c_gdd_migration_ui_constants","./c_icon_shortcuts_icon","./c_workflow_builder_workflow_actions_action_ui_config","./c_pap-events_navigation_navigate_to_replay","./c_action_plugins_open_in_action_dropdown","./c_file_viewer_common_hooks","./c_files_view_data_store","./c_cloud_docs_open_with_utils","./c_file_viewer_components_titlebar_menu_content","./c_core_uri","./c_api_v2_noauth_client","./c_core_attribution_header","./c_csrf","./c_apex-metrics_src_types","./c_referrer_cleansing_redirect","./e_core_exception","./c_lodash-es_lodash","./c_src_sink_index","./c_growth_ui_teams_web_actions_logger_events","./c_keymaster","./c_es_hooks_useDispatch","./c_core_utils_browser_detection","./c_ui-icon_line_zoom-out","./c_campaigns_campaign_enums","./c_bolt_metaserver_clients","./c_skeleton_index","./c_ui-icon_line_restore","./c_toolkit_dist_redux-toolkit","./c_ui-icon_line_team","./c_ui-icon_line_zip","./c_stormcrow_explicit_exposure_logging","./c_stormcrow_gating_factory","./c_stormcrow_types_log_exposure","metaserver/static/js/modules/constants/viewer","./e_edison","./c_init_data_edison","./c_core_xhr","metaserver/static/js/langpack","./c_core_notify","react-dom","metaserver/static/js/modules/constants/web_experience_constants","metaserver/static/js/modules/constants/sharing","metaserver/static/js/modules/constants/locales","metaserver/static/js/modules/constants/file_viewer_configuration","metaserver/static/js/modules/constants/file_viewer_feature_experiments","metaserver/static/js/modules/constants/time","metaserver/static/js/modules/constants/login_and_register","metaserver/static/js/modules/constants/fingerprintjs_constants","./c_security_crypto","./c_browse_models","./c_base64","./c_flux_base_store","./c_chips_index","./c_chip_index","metaserver/static/js/modules/constants/contacts","./c_spectrum_colorized_icon","./c_spectrum_positioned_portal","./c_user_centric_perf_metrics_component_visually_complete_component_visually_complete_calculator","./c_plugin_utils_drawWatermarkOnCanvas","./c_resize-observer-polyfill_dist_ResizeObserver","./c_badges_index","./c_badge_index","./c_react-error-boundary","./c_browse_data_selectors","./c_sync_everything_redux_selectors","./c_flows_utils_async_modal_launchers","./c_flows_redux_selectors","./c_esm_misc_util","./c_browse_tts","./c_file_imports_gdrive_file_picker","./c_ui_title_bubble","./c_core_utils_time_utils","./c_tagging_components_tags_search","./c_data_action_creators_index","./c_tagging_logger","./c_shared_with_redux_store","./c_sharing_avatar_info","./c_structured_tags_redux_selectors","metaserver/static/js/modules/constants/search","./c_folder_dialog_folder_picker_dig","./c_table_columns_file_name_column","./c_src_table","./c_spectrum_icon_arrow_index","./c_browse_interface","./c_folder_dialog_constants","./c_folder_dialog_api","./c_home_store","./c_plugin_utils_getImageDefaultSizes","metaserver/static/js/modules/constants/pdf_editing","metaserver/static/js/modules/constants/unity","./c_spectrum_tooltip","./c_extensions_extensions_utils","./c_spectrum_modal_utility_modal","./c_icon_templates_actionable_index","./c_spectrum_icon_form_index","./c_react_query_api_helpers_queries_cloud_docs_team_settings","./c_starred_star"],(function(e,t,i,o,n,s,r,a,l,c,d,u,_,f,g,p,h,S,v,m,E,I,w,M,F,O,T,A,D,C,b,y,P,L,R,N,k,x,U,G,H,V,z,j,B,K,W,X,$,q,Y,Q,Z,J,ee,te,ie,oe,ne,se,re,ae,le,ce,de,ue,_e,fe,ge,pe,he,Se,ve,me,Ee,Ie,we,Me,Fe,Oe,Te,Ae,De,Ce,be,ye,Pe,Le,Re,Ne,ke,xe,Ue,Ge,He,Ve,ze,je,Be,Ke,We,Xe,$e,qe,Ye,Qe,Ze,Je,et,tt,it,ot,nt,st,rt,at,lt,ct,dt,ut,_t,ft){"use strict";function gt(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(i){if("default"!==i){var o=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:function(){return e[i]}})}})),t.default=e,Object.freeze(t)}var pt=gt(i);const ht=Object.assign(Object.assign({},o.fileActionCondition),{filterValidFile:e=>{const t=o.fileActionCondition.filterValidFile(e);return!t||o.isInsideVaultFolder(t)||o.isPnmSuppressMoveSelected(t)||n.isEncryptedFile(t)?void 0:t}}),St=o.withActionCondition(ht,((t,i,s,r)=>({label:o.COPY_ACTION_STRING,userAction:n.UserAction.Copy,icon:n.CopyLine,action:{type:"click",handler:()=>new Promise((function(t,i){e(["./c_action_plugins_copy_action_action"],t,i)})).then((({copyActionWrapper:e})=>e({file:t.file,user:t.user,previewType:i,browseContext:s,browseExceptions:r})))},disabled:{disabled:!1}})),void 0),vt=o.fileActionCondition,mt=o.withActionCondition(vt,((t,i,r,a,l)=>({label:o.DELETE_ACTION_STRING,icon:s.DeleteLine,userAction:n.UserAction.Delete,disabled:t.file.read_only?{disabled:!0,tooltipMessage:o.ACTION_DISABLED_STRING}:{disabled:!1},action:{type:"click",handler:()=>new Promise((function(t,i){e(["./c_action_plugins_delete_action_action"],t,i)})).then((({deleteActionWrapper:e})=>e({logUserAction:i,setDeleteFileModalOpenCallback:r,file:t.file,user:t.user,previewSurface:a,onFileChanged:l})))}})),void 0),Et="browse_save_as";function It({files:e,template:t,conversionType:i,source:n}){return a.__awaiter(this,void 0,void 0,(function*(){const{initLabel:s,failLabel:a}={initLabel:e=>r.intl.formatMessage({id:"YdruIN",defaultMessage:"Your {numFiles, plural, one {file} other {files}} will be saved shortly..."},{numFiles:e}),failLabel:e=>r.intl.formatMessage({id:"j4UjMR",defaultMessage:"There was a problem saving your {numFiles, plural, one {file} other {files}}"},{numFiles:e})};c.updateSnackbar({variant:"sync",title:s(e.length)});const l=o.getConversionLoggingFunctions(i);_.getStoreForAutomations().dispatch(f.setShouldSubscribeToBolt(!0));try{yield d.submitFileWorkflow(t,e.map((e=>e.file_id))),u.PapLogger.logSucceedSubmitManualWorkflow(Et,t,e.length),l.logConvert(n,e.length)}catch(i){c.updateSnackbar({variant:"fail",title:a(e.length)}),u.PapLogger.logFailSubmitManualWorkflow(Et,t,e.length,i)}}))}const wt="pdf",Mt={actionText:"PDF",actionIcon:p.FileLine,selector:o.singleFileWithExtensionSelector(g.SUPPORTED_PDF_EXTENSIONS),convert:(e,t,i)=>{const{source:n}=i;return l.convertFileAndShowSnackbar(Object.assign(Object.assign({},i),{file:e[0],user:t,conversionType:wt,folderRuleAction:"pdf_conversion",loggingFunctions:o.getConversionLoggingFunctions(wt),getStrings:(e,i)=>o.getDefaultConversionStrings("PDF",e,t,i),conversionFn:(e,t,i)=>a.__awaiter(void 0,void 0,void 0,(function*(){return(yield l.convertToPdf(t.id,o.getFileIdentifier(e,i))).path})),getAdoptionSnackbarProps:i=>l.getAdoptionSnackbarProps({user:t,conversionType:wt,folderRuleAction:"pdf_conversion",fileType:"PDF",resultPath:i,source:n,nsId:e[0].ns_id}),template:{sequence:[{workflow_action:{".tag":"pdf_conversion"}}]},outputExt:"PDF"}))}},Ft={actionText:"PDF",actionIcon:p.FileLine,selector:o.strictMultiFileWithExtensionSelector(g.SUPPORTED_PDF_EXTENSIONS),convert:(e,t,{source:i})=>It({files:e,template:{sequence:[{workflow_action:{".tag":"pdf_conversion"}}]},conversionType:wt,source:i})},Ot={jpg:g.SUPPORTED_IMAGE_INPUT_EXTENSIONS.filter((e=>"jpg"!==e&&"jpeg"!==e)),png:g.SUPPORTED_IMAGE_INPUT_EXTENSIONS.filter((e=>"png"!==e))},Tt="image-format",At=Object.entries(Ot).map((([e,t])=>({actionText:e.toUpperCase(),actionIcon:s.ImageLine,selector:o.singleFileWithExtensionSelector(t),convert:(t,i,n)=>{const{source:s}=n;return l.convertFileAndShowSnackbar(Object.assign(Object.assign({},n),{file:t[0],user:i,conversionType:Tt,folderRuleAction:"image_conversion",loggingFunctions:o.getConversionLoggingFunctions(Tt),getStrings:(t,n)=>o.getDefaultConversionStrings(e.toUpperCase(),t,i,n),conversionFn:(t,i,n)=>a.__awaiter(void 0,void 0,void 0,(function*(){return(yield l.convertImageFormat(i.id,o.getFileIdentifier(t,n),e)).path})),getAdoptionSnackbarProps:o=>l.getAdoptionSnackbarProps({user:i,conversionType:Tt,folderRuleAction:"image_conversion",fileType:e,resultPath:o,source:s,nsId:t[0].ns_id}),outputExt:e}))}}))),Dt="doc-to-image",Ct=g.SUPPORTED_IMAGE_OUTPUT_EXTENSIONS.map((e=>({actionText:e.toUpperCase(),actionIcon:s.ImageLine,selector:o.singleFileWithExtensionSelector(g.SUPPORTED_DOC_INPUT_EXTENSIONS),convert:(t,i,n)=>{const{source:s}=n;return l.convertFileAndShowSnackbar(Object.assign(Object.assign({},n),{file:t[0],user:i,conversionType:Dt,folderRuleAction:"image_conversion",loggingFunctions:o.getConversionLoggingFunctions(Dt),getStrings:(t,n)=>o.getDefaultConversionStrings(e.toUpperCase(),t,i,n),conversionFn:(t,i,n)=>a.__awaiter(void 0,void 0,void 0,(function*(){return(yield l.convertDocToImage(i.id,o.getFileIdentifier(t,n),e)).path})),getAdoptionSnackbarProps:o=>l.getAdoptionSnackbarProps({user:i,conversionType:Dt,folderRuleAction:"image_conversion",fileType:e,resultPath:o,source:s,nsId:t[0].ns_id}),outputExt:e}))}}))),bt="media-remux",yt=(e,t,i)=>(n,s,c)=>{const{source:d}=c;return l.convertFileAndShowSnackbar(Object.assign(Object.assign({},c),{file:n[0],user:s,conversionType:bt,folderRuleAction:t,loggingFunctions:o.getConversionLoggingFunctions(bt),getStrings:(t,i)=>function(e,t,i,n){const s=o.getDefaultConversionStrings(e,t,i,n);return Object.assign(Object.assign({},s),{failTooLarge:r.intl.formatMessage({id:"D67i/e",defaultMessage:"Couldn't save as {fileType} because the file is too large. The maximum file size is {maxSize} MB."},{fileType:e,maxSize:g.MEDIA_REMUX_FILE_SIZE_LIMIT})})}(e.toUpperCase(),t,s,i),conversionFn:(t,i,n)=>a.__awaiter(void 0,void 0,void 0,(function*(){return(yield l.mediaRemux(i.id,o.getFileIdentifier(t,n),e)).path})),getAdoptionSnackbarProps:t?i=>l.getAdoptionSnackbarProps({user:s,conversionType:bt,folderRuleAction:t,fileType:e,resultPath:i,source:d,nsId:n[0].ns_id}):void 0,template:i,outputExt:e,asyncThresholdBytes:134217728}))},Pt=[...g.SUPPORTED_VIDEO_OUTPUT_CONTAINERS.map((e=>({actionText:e.toUpperCase(),actionIcon:h.VideoLine,selector:o.singleFileWithExtensionSelector(g.SUPPORTED_VIDEO_INPUT_EXTENSIONS.filter((t=>t!==e))),convert:yt(e,"video_conversion",{sequence:[{workflow_action:{".tag":"video_conversion",format:e}}]})}))),...g.SUPPORTED_AUDIO_OUTPUT_CONTAINERS.map((e=>({actionText:e.toUpperCase(),actionIcon:S.AudioLine,selector:o.singleFileWithExtensionSelector([...g.SUPPORTED_AUDIO_INPUT_EXTENSIONS,...g.SUPPORTED_VIDEO_INPUT_EXTENSIONS].filter((t=>t!==e))),convert:yt(e,"audio_conversion",{sequence:[{workflow_action:{".tag":"audio_conversion",format:e}}]})})))],Lt=[...g.SUPPORTED_VIDEO_OUTPUT_CONTAINERS.map((e=>({actionText:e.toUpperCase(),actionIcon:h.VideoLine,selector:o.strictMultiFileWithExtensionSelector(g.SUPPORTED_VIDEO_INPUT_EXTENSIONS.filter((t=>t!==e))),convert:(t,i,{source:o})=>It({files:t,template:{sequence:[{workflow_action:{".tag":"video_conversion",format:e}}]},conversionType:bt,source:o})}))),...g.SUPPORTED_AUDIO_OUTPUT_CONTAINERS.map((e=>({actionText:e.toUpperCase(),actionIcon:S.AudioLine,selector:o.strictMultiFileWithExtensionSelector([...g.SUPPORTED_AUDIO_INPUT_EXTENSIONS,...g.SUPPORTED_VIDEO_INPUT_EXTENSIONS].filter((t=>t!==e))),convert:(t,i,{source:o})=>It({files:t,template:{sequence:[{workflow_action:{".tag":"audio_conversion",format:e}}]},conversionType:bt,source:o})})))];const Rt=g.SUPPORTED_DOC_INPUT_EXTENSIONS.concat(g.SUPPORTED_IMAGE_INPUT_EXTENSIONS),Nt={jpg:Rt.filter((e=>"jpg"!==e&&"jpeg"!==e)),png:Rt.filter((e=>"png"!==e))},kt=Object.entries(Nt).map((([e,t])=>({actionText:e.toUpperCase(),actionIcon:s.ImageLine,selector:o.strictMultiFileWithExtensionSelector(t),convert:(t,i,{source:o})=>It({files:t,conversionType:"image-batch",template:{sequence:[{workflow_action:{".tag":"image_conversion",format:e}}]},source:o})})));var xt;!function(e){e[e.DEFAULT=0]="DEFAULT",e[e.CLOUD_DOCS=1]="CLOUD_DOCS",e[e.VIDEO_SCALE=2]="VIDEO_SCALE"}(xt||(xt={}));const Ut=JSON.parse('\n    {"dlink":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 24"},"dangerouslySetInnerIconHtml":"<path d=\\"M4.222 12.914a4.5 4.5 0 0 0 6.364 6.364l2.475-2.475-1.414-1.414-2.475 2.475a2.5 2.5 0 0 1-3.536-3.536l3.536-3.535a2.5 2.5 0 0 1 3.535 0l1.061 1.06 1.414-1.414-1.06-1.06a4.5 4.5 0 0 0-6.364 0l-3.536 3.535z\\" fill=\\"currentColor\\"></path><path d=\\"M19.778 10.086a4.5 4.5 0 0 0-6.364-6.364L10.94 6.197l1.414 1.414 2.475-2.475a2.5 2.5 0 0 1 3.535 3.536l-3.535 3.535a2.5 2.5 0 0 1-3.536 0l-1.06-1.06-1.415 1.414 1.06 1.06a4.5 4.5 0 0 0 6.365 0l3.535-3.535z\\" fill=\\"currentColor\\"></path>"},"dropbox_form":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 30"},"dangerouslySetInnerIconHtml":"<path d=\\"M20.907 3.97h-2.819v-.93c0-.69-.559-1.249-1.248-1.249H14.7V.626A.622.622 0 0 0 14.074 0h-5.11a.626.626 0 0 0-.626.626v1.165h-2.13c-.69 0-1.25.56-1.25 1.249v.93H2.132A2.162 2.162 0 0 0 0 6.129v21.53a2.162 2.162 0 0 0 2.13 2.179h18.777a2.162 2.162 0 0 0 2.131-2.18V6.127a2.162 2.162 0 0 0-2.13-2.156zm.053 23.1a.622.622 0 0 1-.626.627H2.687a.626.626 0 0 1-.627-.626V6.776c0-.346.28-.626.627-.626H4.94v1.707a.626.626 0 0 0 .627.627h11.89a.626.626 0 0 0 .63-.666V6.11h2.255a.622.622 0 0 1 .626.627L20.96 27.07z\\" fill=\\"#727880\\" fill-rule=\\"nonzero\\"></path>"},"dropbox_paper":{"attrs":{"width":"30","height":"30","viewBox":"0 0 30 30"},"dangerouslySetInnerIconHtml":"<path fill=\\"none\\" d=\\"M0 0h30v30H0z\\"></path><path fill=\\"none\\" d=\\"M4 3h22.883v24H4z\\"></path><path fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M4 19.71L15.441 27l11.442-7.29-11.441-7.288L4 19.712z\\" fill=\\"#B6D2EA\\"></path><path fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M4 10.288l11.442 7.29 11.441-7.29L15.442 3 4 10.288z\\" fill=\\"#0061FF\\"></path>"},"dropbox_paper_template":{"attrs":{"width":"30","height":"30","viewBox":"0 0 30 30"},"dangerouslySetInnerIconHtml":"<path fill=\\"none\\" d=\\"M0 0h30v30H0z\\"></path><path fill=\\"none\\" d=\\"M4 3h22.883v24H4z\\"></path><path fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M4 19.71L15.441 27l11.442-7.29-11.441-7.288L4 19.712z\\" fill=\\"#6A7C8F\\"></path><path fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M4 10.288l11.442 7.29 11.441-7.29L15.442 3 4 10.288z\\" fill=\\"#1B2733\\"></path>"},"dropbox_paper_binder":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 24"},"dangerouslySetInnerIconHtml":"<g clip-path=\\"url(#mc-partners-dropbox_paper_binder-a)\\" fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" fill=\\"#0061FF\\"><path d=\\"M11.92 22.107l-8.402-5.361-1.491.95L11.92 24l9.894-6.303-1.484-.951-8.41 5.36z\\"></path><path d=\\"M11.92 18.303l-8.402-5.352-1.491.95 9.893 6.304 9.894-6.303-1.484-.951-8.41 5.352z\\"></path><path d=\\"M11.92 14.508l-8.402-5.36-1.491.95 9.893 6.304 9.894-6.304-1.484-.95-8.41 5.36z\\"></path><path d=\\"M2.027 6.303l9.893 6.304 9.894-6.304L11.92 0 2.027 6.303z\\"></path></g><defs><clipPath id=\\"mc-partners-dropbox_paper_binder-a\\"><path fill=\\"#fff\\" d=\\"M0 0h24v24H0z\\"></path></clipPath></defs>"},"google_gdoc":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 24"},"dangerouslySetInnerIconHtml":"<rect x=\\"3\\" y=\\"3\\" width=\\"18\\" height=\\"18\\" rx=\\"2\\" fill=\\"#4285F4\\"></rect><path d=\\"M18 7H6v2h12V7zM18 11H6v2h12v-2zM14 15H6v2h8v-2z\\" fill=\\"#fff\\"></path>"},"google_gsheet":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 24"},"dangerouslySetInnerIconHtml":"<rect x=\\"3\\" y=\\"3\\" width=\\"18\\" height=\\"18\\" rx=\\"2\\" fill=\\"#0F9D58\\"></rect><path fill=\\"#fff\\" d=\\"M9 5h2v14H9z\\"></path><path fill=\\"#fff\\" d=\\"M5 9h14v2H5z\\"></path>"},"google_gslides":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 24"},"dangerouslySetInnerIconHtml":"<rect x=\\"3\\" y=\\"3\\" width=\\"18\\" height=\\"18\\" rx=\\"2\\" fill=\\"#F4B400\\"></rect><path fill=\\"#fff\\" d=\\"M5 8h14v8H5z\\"></path>"},"microsoft_docx":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 24"},"dangerouslySetInnerIconHtml":"<path d=\\"M1 3l13-2v21L1 20V3z\\" fill=\\"#2B579A\\"></path><path d=\\"M13 3h9a1 1 0 0 1 1 1v15a1 1 0 0 1-1 1h-9V3z\\" fill=\\"#2B579A\\"></path><path fill=\\"#fff\\" d=\\"M14 4h8v15h-8z\\"></path><path fill=\\"#2B579A\\" d=\\"M13 6h7v1h-7zM13 9h7V8h-7zM13 11h7v-1h-7zM13 13h7v-1h-7zM13 15h7v-1h-7zM13 17h7v-1h-7z\\"></path><path d=\\"M12 8l-1.687 7H8.72l-1.06-4.49a4.084 4.084 0 0 1-.102-.787H7.54c-.027.32-.065.581-.116.786L6.338 15h-1.66L3 8h1.571l.9 4.662c.038.198.066.465.084.8h.027c.011-.25.054-.524.129-.82L6.868 8h1.54l1.046 4.7c.039.173.073.424.102.753h.018c.012-.258.043-.518.094-.781L10.549 8H12z\\" fill=\\"#fff\\"></path>"},"microsoft_pptx":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 24"},"dangerouslySetInnerIconHtml":"<path d=\\"M1 3l13-2v21L1 20V3z\\" fill=\\"#D24726\\"></path><path d=\\"M7 13v3H5V7h2.897C9.966 7 11 7.956 11 9.868c0 .904-.298 1.636-.893 2.197A3.388 3.388 0 0 1 7.73 13H7zm0-4.444v2.806h.576c.985 0 1.477-.473 1.477-1.418 0-.925-.492-1.388-1.477-1.388H7z\\" fill=\\"#fff\\"></path><path d=\\"M13 3h9a1 1 0 0 1 1 1v15a1 1 0 0 1-1 1h-9V3z\\" fill=\\"#D24726\\"></path><path fill=\\"#fff\\" d=\\"M14 4h8v15h-8z\\"></path><path fill=\\"#D24726\\" d=\\"M14 15h6v-1h-6zM14 17h6v-1h-6z\\"></path><path fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M16 13a3 3 0 0 0 3-3h-3V7a3 3 0 0 0 0 6z\\" fill=\\"#D24726\\"></path><path fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M20 9a3 3 0 0 0-3-3v3h3z\\" fill=\\"#D24726\\"></path>"},"microsoft_xlsx":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 24"},"dangerouslySetInnerIconHtml":"<path d=\\"M1 3l13-2v21L1 20V3z\\" fill=\\"#217346\\"></path><path d=\\"M13 3h9a1 1 0 0 1 1 1v15a1 1 0 0 1-1 1h-9V3z\\" fill=\\"#217346\\"></path><path fill=\\"#fff\\" d=\\"M14 4h8v15h-8z\\"></path><path fill=\\"#217346\\" d=\\"M14 14h2v-1h-2zM14 16h2v-1h-2zM14 10h2V9h-2zM14 12h2v-1h-2zM14 8h2V7h-2zM17 14h3v-1h-3zM17 16h3v-1h-3zM17 10h3V9h-3zM17 12h3v-1h-3zM17 8h3V7h-3z\\"></path><path d=\\"M6 7H4l2 4.5L4 16h2l1-3 1 3h2l-2-4.5L10 7H8l-1 3-1-3z\\" fill=\\"#fff\\"></path>"},"shortcut":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 24"},"dangerouslySetInnerIconHtml":"<path fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M13 18v-3.016a1.2 1.2 0 0 0-.965-1.177l-.358-.072a1.799 1.799 0 0 1-1.053-.64 4.984 4.984 0 0 0-.335-.666 1.84 1.84 0 0 1-.024-.106l-.168-.836a1.2 1.2 0 0 0-.51-.763l-.567-.377a1.167 1.167 0 0 1-.52-.972.875.875 0 0 0-.875-.875H6.46c-.183.477-.315.98-.39 1.5H4.056A9.001 9.001 0 0 1 22 11a9 9 0 0 1-11 8.777V17.71c.634.189 1.305.29 2 .29zm7-7a6.968 6.968 0 0 1-1.21 3.935 3 3 0 0 0-2.949-2.435h-2.24a.6.6 0 0 1-.6-.6V9.974c0-.29.163-.556.423-.686a1.915 1.915 0 0 0 1.058-1.741l-.05-3.4A7.002 7.002 0 0 1 20 11z\\" fill=\\"#0061FF\\"></path><path d=\\"M8.499 12H2.443l2.253 2.253c-3.513 3.711-2.712 7.364-2.367 8.434.03.095.165.086.192-.01.24-.852 1.147-3.317 4.174-6.425L8.943 18.5v-6.056A.444.444 0 0 0 8.499 12z\\" fill=\\"#717781\\"></path>"}}\n  '),Gt=e=>{const{name:t}=e,i=pt.createElement(v.SvgIconBundle,{focusable:"false",icon:Ut[t]});return pt.createElement(v.Component,Object.assign({icon:i},e))};var Ht;Gt.displayName="IconPartners",function(e){e.GOOGLE_DRIVE="web_shortcut",e.MICROSOFT_FILE="ms_file"}(Ht||(Ht={}));const Vt=(e,t,i,o,s)=>{n.logEvent({class:"cloud_docs",action:"select",object:"cloud_docs_manual_conversion_modal",properties:{accountRole:e,numFiles:t,cloudDocsManualConversionType:i,cloudDocsManualConversionModalButton:o,dontAskAgainChecked:s}})},zt=(e,t)=>{n.logEvent({class:"cloud_docs",action:"open",object:"cloud_docs_manual_conversion_folder_picker",properties:{accountRole:e,eventState:t}})},jt=(e,t,i,o,s,r,a,l)=>{n.logEvent({class:"cloud_docs",action:"initiate",object:"cloud_docs_manual_conversion",properties:{accountRole:e,numFiles:t,cloudDocsManualConversionType:i,modalWasShown:o,copyFilePermissions:s,useDefaultFolder:r,cloudDocsManualConversionError:a,eventState:l}})},Bt=(e,t)=>{switch(t){case Ht.GOOGLE_DRIVE:return(e=>{const t=new Set;for(const i of e){const e=M.getGoogleFileTypeByPath(i);if(e){t.add(e);continue}const o=M.getMicrosoftFileTypeByPath(i);o&&t.add(M.MicrosoftToGoogleFileTypes[o])}if(1===t.size)for(const e of t)return M.GoogleFileLabels[e];return r.intl.formatMessage({id:"ZYjkCp",defaultMessage:"Google"})})(e);case Ht.MICROSOFT_FILE:return(e=>{const t=new Set;for(const i of e){const e=M.getMicrosoftFileTypeByPath(i);if(e){t.add(e);continue}const o=M.getGoogleFileTypeByPath(i);o&&t.add(M.GoogleToMicrosoftFileTypes[o])}if(1===t.size)for(const e of t)return M.MicrosoftFileLabels[e];return r.intl.formatMessage({id:"WbLFdE",defaultMessage:"Microsoft"})})(e)}},Kt=({srcFileNames:e,targetDest:t,folderName:i=I.Strings.MIGRATION_FOLDER,onChangeDriveFolder:o,onLearnMore:s})=>{const a=Bt(e,t);switch(t){case Ht.GOOGLE_DRIVE:return r.intl.formatMessage({id:"pU1fIE",defaultMessage:"{numFiles, plural, one{The new {fileTypeLabel} shortcut (to be saved in <folderPickerButton>{folderName}</folderPickerButton>) will inherit the same sharing permissions as the original file. Save as will replace the original file.} other{The new {fileTypeLabel} shortcuts (to be saved in <folderPickerButton>{folderName}</folderPickerButton>) will inherit the same sharing permissions as the original files. Save as will replace the original files.}} <button>Learn more</button>"},{fileTypeLabel:a,numFiles:e.length,folderName:i,bold:e=>pt.default.createElement(n.Text,{isBold:!0},e),button:e=>pt.default.createElement(n.Button,{variant:"transparent",onClick:s},e),folderPickerButton:e=>pt.default.createElement(n.Button,{onClick:o,variant:"transparent",withIconLeft:pt.default.createElement(n.UIIcon,{src:F.FolderLine,role:"presentation"})},e)});case Ht.MICROSOFT_FILE:return r.intl.formatMessage({id:"gctOhH",defaultMessage:"{numFiles, plural, one{The new {fileTypeLabel} file will inherit the same sharing permissions as the original file. Save as will replace the original file.} other{The new {fileTypeLabel} files will inherit the same sharing permissions as the original files. Save as will replace the original files.}} <button>Learn more</button>"},{fileTypeLabel:a,numFiles:e.length,bold:e=>pt.default.createElement(n.Text,{isBold:!0},e),button:e=>pt.default.createElement(n.Button,{variant:"transparent",onClick:()=>{}},e)})}};var Wt;!function(e){e.pendingSaveShortcuts=function(e){return r.intl.formatMessage({id:"EXRMbA",defaultMessage:"Saving as {numFiles, plural, one{shortcut} other{shortcuts}} in Google Drive..."},{numFiles:e})},e.pendingSaveMsFiles=function(e){return r.intl.formatMessage({id:"xNu9kx",defaultMessage:"Saving as Microsoft {numFiles, plural, one{file} other{files}}..."},{numFiles:e})},e.successMessageShortcuts=function(e){return r.intl.formatMessage({id:"BwnqL+",defaultMessage:"{numFiles, plural, one{1 file saved as Google file shortcut} other{# files saved as Google file shortcuts}}."},{numFiles:e})},e.successMessageMultipleMsFiles=function(e){return r.intl.formatMessage({id:"ZXYeoK",defaultMessage:"{numFiles} files saved as Microsoft files."},{numFiles:e})},e.successMessageOneShortcut=function(e){return r.intl.formatMessage({id:"osYTsQ",defaultMessage:"{filename} saved to Google Drive."},{filename:e})},e.successMessageOneMsFile=function(e){return r.intl.formatMessage({id:"0kS6qL",defaultMessage:"{filename} saved."},{filename:e})},e.SERVER_ERROR=r.intl.formatMessage({id:"+rrsxb",defaultMessage:"Server error"}),e.srcFilesNotFound=function(e){return r.intl.formatMessage({id:"eRab3W",defaultMessage:"Source {numFiles, plural, one{file} other{files}} not found"},{numFiles:e})},e.srcFilesWrongType=function(e){return r.intl.formatMessage({id:"V0eQ4f",defaultMessage:"Source {numFiles, plural, one{file} other{files}} of the wrong type"},{numFiles:e})},e.GOOGLE_ACCOUNT_NOT_LINKED=r.intl.formatMessage({id:"Qs6YhO",defaultMessage:"Google account not linked"}),e.FOLDER_CREATION_FAILED=r.intl.formatMessage({id:"gBED0D",defaultMessage:"Folder creation failed"}),e.FIND_UNUSED_FILENAME_FAILED=r.intl.formatMessage({id:"UgrtDM",defaultMessage:"Find unused filename failed"}),e.UPLOAD_FAILED=r.intl.formatMessage({id:"MQocdR",defaultMessage:"Upload failed"}),e.GRANT_PERMISSIONS_FAILED=r.intl.formatMessage({id:"OltuRn",defaultMessage:"Grant permissions failed"}),e.CREATE_FILE_FAILED=r.intl.formatMessage({id:"8eZdXo",defaultMessage:"Create file failed"}),e.DELETE_FILE_FAILED=r.intl.formatMessage({id:"QoVCWl",defaultMessage:"Delete file failed"}),e.FIND_FOLDER_FAILED=r.intl.formatMessage({id:"6phdrE",defaultMessage:"Find folder failed"}),e.INVALID_DEST_FOLDER_MIME_TYPE=r.intl.formatMessage({id:"+DHCWS",defaultMessage:"Destination folder invalid"}),e.GOOGLE_SERVER_ERROR=r.intl.formatMessage({id:"gTHqcG",defaultMessage:"Google server error"}),e.NO_WRITE_PERMISSION=r.intl.formatMessage({id:"EYJIs6",defaultMessage:"User has no write access"}),e.singleFileFailSaveShortcut=function({filename:e,rootCause:t}){return e?r.intl.formatMessage({id:"LsI80W",defaultMessage:"{filename} couldn’t be saved to Google Drive ({rootCause})."},{filename:e,rootCause:t}):r.intl.formatMessage({id:"IYz0cM",defaultMessage:"File couldn’t be saved to Google Drive ({rootCause})."},{rootCause:t})},e.singleFileFailSaveMsFile=function({filename:e,rootCause:t}){return e?r.intl.formatMessage({id:"fvHSWo",defaultMessage:"{filename} couldn’t be saved ({rootCause})."},{filename:e,rootCause:t}):r.intl.formatMessage({id:"nARyLu",defaultMessage:"File couldn’t be saved ({rootCause})."},{rootCause:t})},e.multipleFilesPartialFailureShortcuts=function(e){return r.intl.formatMessage({id:"4UgBQ9",defaultMessage:"Some files couldn’t be saved as shortcuts ({rootCause})."},{rootCause:e})},e.multipleFilesFullFailureShortcuts=function(e){return r.intl.formatMessage({id:"Q9gfPh",defaultMessage:"Files couldn’t be saved as shortcuts ({rootCause})."},{rootCause:e})},e.multipleFilesFullFailureMsFile=function(e){return r.intl.formatMessage({id:"O1bxfj",defaultMessage:"Files couldn’t be saved as Microsoft files ({rootCause})."},{rootCause:e})},e.FAILED_TO_GET_GOOGLE_SHORTCUT_SETTINGS=r.intl.formatMessage({id:"AoDCl3",defaultMessage:"Failed to get Google shortcut settings. Please try again."})}(Wt||(Wt={}));const Xt=e=>"ns_path"in e?n.filename(e.ns_path):void 0,$t=e=>a.__awaiter(void 0,void 0,void 0,(function*(){try{const t=new E.UserApiV2Client;return yield m.GetCloudDocsRoutes(t).rpc("google_shortcut_settings/get",void 0,{subjectUserId:e.id})}catch(e){return n.Snackbar$1.failSticky(Wt.FAILED_TO_GET_GOOGLE_SHORTCUT_SETTINGS),null}})),qt=({user:e,dontAskMeAgain:t,copyFilePermissions:i})=>a.__awaiter(void 0,void 0,void 0,(function*(){const o=(({dontAskMeAgain:e,copyFilePermissions:t})=>e?t?{".tag":"always"}:{".tag":"never"}:{".tag":"ask_each_time"})({dontAskMeAgain:t,copyFilePermissions:i}),n=new E.UserApiV2Client;try{yield m.GetCloudDocsRoutes(n).rpc("google_shortcut_settings/set",{copy_permissions_to_google_shortcut:o},{subjectUserId:e.id})}catch(e){}})),Yt=({user:e,srcFileNames:t,targetDest:o,onUpdateCopyPermissionsSetting:s,onSubmit:l})=>{const[c,d]=i.useState(!1),[{folderName:u,folderId:_},f]=i.useState({folderName:I.Strings.MIGRATION_FOLDER});i.useEffect((()=>{var i,s,r;i=e.role,s=t.length,r=o,n.logEvent({class:"cloud_docs",action:"shown",object:"cloud_docs_manual_conversion_modal",properties:{accountRole:i,numFiles:s,cloudDocsManualConversionType:r}})}),[e.role,t.length,o]);const g=i.useCallback((()=>a.__awaiter(void 0,void 0,void 0,(function*(){zt(e.role,"start");try{if((yield I.ensureUserHasGddMigrationCompatibleLink(e))!==I.GddMigrationCompatibleLinkStatus.HAS_COMPATIBLE_LINK)return void zt(e.role,"canceled")}catch(e){const t=I.getUserFriendlyLinkAccountErrorMessage(e);return void(t&&n.Snackbar$1.failSticky(t))}try{const t=yield O.chooseGdriveFolder(e.id);t?(zt(e.role,"success"),f(t)):zt(e.role,"canceled")}catch(t){zt(e.role,"failed")}}))),[e]),p=()=>{n.open_tab(O.HELP_CENTER_ARTICLE_URL)},h=i.useMemo((()=>(({srcFileNames:e,targetDest:t,dontAskMeAgain:i,folderName:o,onChangeDriveFolder:s,onSetDontAskMeAgain:a,onConvertAndCopy:l,onConvertButDontCopy:c,onLearnMore:d})=>({title:r.intl.formatMessage({id:"taJUkh",defaultMessage:"Save with sharing permissions?"}),bodyText:pt.default.createElement(pt.default.Fragment,null,Kt({srcFileNames:e,targetDest:t,folderName:o,onChangeDriveFolder:s,onLearnMore:d})),actions:pt.default.createElement(pt.default.Fragment,null,pt.default.createElement(n.Checkbox,{id:"toggleDontAskMeAgain",checked:i,onChange:e=>a(e.currentTarget.checked),"aria-label":r.intl.formatMessage({id:"PJIYJF",defaultMessage:"Toggle don’t ask me again"})}),pt.default.createElement(n.Label,{htmlFor:"toggleDontAskMeAgain"},pt.default.createElement(n.Text,null,r.intl.formatMessage({id:"rI2pNz",defaultMessage:"Don’t ask me again"})))),tertiaryActions:pt.default.createElement(pt.default.Fragment,null,pt.default.createElement(n.Button,{variant:"opacity",onClick:c},r.intl.formatMessage({id:"QzQNL5",defaultMessage:"Save without permissions"})),pt.default.createElement(n.Button,{variant:"primary",onClick:l},I.Strings.SAVE)),width:"standard",withCloseButton:I.Strings.CLOSE}))({srcFileNames:t,targetDest:o,dontAskMeAgain:c,folderName:u,onChangeDriveFolder:g,onSetDontAskMeAgain:e=>d(e),onConvertAndCopy:()=>{n.Modal$1.close(),s({dontAskMeAgain:c,copyFilePermissions:!0}),Vt(e.role,t.length,o,"save_with_permissions",c),l({modalWasShown:!0,copyFilePermissions:!0,folderId:_})},onConvertButDontCopy:()=>{n.Modal$1.close(),s({dontAskMeAgain:c,copyFilePermissions:!1}),Vt(e.role,t.length,o,"save_without_permissions",c),l({modalWasShown:!0,copyFilePermissions:!1,folderId:_})},onLearnMore:p})),[t,o,c,u,g,s,e.role,l,_]);return pt.default.createElement(I.ModalTemplate,Object.assign({open:!0},h,{onRequestClose:()=>{var i,s,r;n.Modal$1.close(),i=e.role,s=t.length,r=o,n.logEvent({class:"cloud_docs",action:"dismiss",object:"cloud_docs_manual_conversion_modal",properties:{accountRole:i,numFiles:s,cloudDocsManualConversionType:r}})}}))};Yt.displayName="ManualConversionComponent";const Qt=({user:e,srcFileNames:t,targetDest:i,copyPermissionsSetting:o,onUpdateCopyPermissionsSetting:s,onSubmit:r})=>{switch(o[".tag"]){case"always":return void r({modalWasShown:!1,copyFilePermissions:!0});case"never":return void r({modalWasShown:!1,copyFilePermissions:!1})}n.Modal$1.showInstance(pt.default.createElement(Yt,{user:e,srcFileNames:t,targetDest:i,onUpdateCopyPermissionsSetting:s,onSubmit:r}))},Zt=({files:e,user:t,modalWasShown:i,copyFilePermissions:o,folderId:s})=>a.__awaiter(void 0,void 0,void 0,(function*(){const r="web_shortcut",a=!s,l="none";if(jt(t.role,e.length,r,i,o,a,l,"start"),!(yield I.ensureUserHasLinkedAccountAndReport(t)))return;n.Snackbar$1.sync(Wt.pendingSaveShortcuts(e.length));const c={src_files:e.map((e=>e.file_id)),keep_original_file:!1,copy_permissions:o,dest_folder_id:s};try{const s=new E.UserApiV2Client,d=yield m.GetCloudDocsRoutes(s).rpc("convert_to_web_shortcut_with_atf",c,{subjectUserId:t.id}),{success:u,task_gid:_}=d.schedule_result;if(!u)throw new Error;yield Jt(s,t,_),jt(t.role,e.length,r,i,o,a,l,"success"),((e,t)=>{t?n.Snackbar$1.completeSticky(Wt.successMessageOneShortcut(n.filename(t))):n.Snackbar$1.completeSticky(Wt.successMessageShortcuts(e.length))})(e)}catch(s){const l=((e,t)=>{let i=!1,o="server_error",s=Wt.SERVER_ERROR;if(t instanceof w.AppError){const r=t.error;switch(r[".tag"]){case"src_file_not_found":o="src_file_not_found",s=Wt.srcFilesNotFound(e.length);break;case"src_file_wrong_type":o="src_file_wrong_type",s=Wt.srcFilesWrongType(e.length);break;case"missing_linked_service":o="google_account_not_linked",s=Wt.GOOGLE_ACCOUNT_NOT_LINKED;break;case"no_write_permission":s=Wt.NO_WRITE_PERMISSION;break;case"external_api_error":switch(i=r.is_partial_failure,r.error_sub_type[".tag"]){case"create_folder":o="folder_creation_failed",s=Wt.FOLDER_CREATION_FAILED;break;case"find_unused_filename":o="find_unused_filename_failed",s=Wt.FIND_UNUSED_FILENAME_FAILED;break;case"upload":o="upload_failed",s=Wt.UPLOAD_FAILED;break;case"grant_role":o="grant_permissions_failed",s=Wt.GRANT_PERMISSIONS_FAILED;break;case"create_file":o="create_file_failed",s=Wt.CREATE_FILE_FAILED;break;case"delete_file":o="delete_file_failed",s=Wt.DELETE_FILE_FAILED;break;case"find_file_or_folder":o="find_folder_failed",s=Wt.FIND_FOLDER_FAILED;break;case"other":o="google_server_error",s=Wt.GOOGLE_SERVER_ERROR;break;default:n.enforceExhaustive(r.error_sub_type)}break;case"invalid_dest_folder_mime_type":o="invalid_dest_folder_mime_type",s=Wt.INVALID_DEST_FOLDER_MIME_TYPE}}else t instanceof Error&&t.message&&(s=t.message);if(1===e.length){const t=Xt(e[0]);n.Snackbar$1.failSticky(Wt.singleFileFailSaveShortcut({filename:t,rootCause:s}))}else i?n.Snackbar$1.failSticky(Wt.multipleFilesPartialFailureShortcuts(s)):n.Snackbar$1.failSticky(Wt.multipleFilesFullFailureShortcuts(s));return o})(e,s);jt(t.role,e.length,r,i,o,a,l,"failed")}})),Jt=(e,t,i)=>a.__awaiter(void 0,void 0,void 0,(function*(){return new Promise(((o,n)=>{const s=setInterval((()=>a.__awaiter(void 0,void 0,void 0,(function*(){var r,a;try{const l=yield ei(e,t,i);"success"===(null===(r=l.status)||void 0===r?void 0:r[".tag"])?(o(),clearInterval(s)):"fatal_failure"===(null===(a=l.status)||void 0===a?void 0:a[".tag"])&&(n(new Error(l.result)),clearInterval(s))}catch(e){clearInterval(s),n(e)}}))),1e3)}))})),ei=(e,t,i)=>a.__awaiter(void 0,void 0,void 0,(function*(){return m.GetCloudDocsRoutes(e).rpc("get_atf_task_status",{task_gid:i},{subjectUserId:t.id})})),ti=({files:e,user:t,modalWasShown:i,copyFilePermissions:o})=>a.__awaiter(void 0,void 0,void 0,(function*(){const s="ms_file",r=void 0,a="none";jt(t.role,e.length,s,i,o,r,a,"start");const l=[];for(let t=0;t<e.length;t+=4){const i=e.slice(t,t+4);l.push({src_files:i.map((e=>e.file_id)),keep_original_file:!1,preserve_existing_ms_file:!0,copy_permissions:o})}n.Snackbar$1.sync(Wt.pendingSaveMsFiles(e.length));const c=new E.UserApiV2Client;try{const d=yield Promise.all(l.map((e=>m.GetCloudDocsRoutes(c).rpc("convert_gdd_to_ms_office_file",e,{subjectUserId:t.id}))));jt(t.role,e.length,s,i,o,r,a,"success"),((e,t)=>{e.length>1?n.Snackbar$1.completeSticky(Wt.successMessageMultipleMsFiles(e.length)):n.Snackbar$1.completeSticky(Wt.successMessageOneMsFile(n.filename(t)))})(e,d[0].converted_files[0].dest_file_path)}catch(a){const l=((e,t)=>{let i="server_error",o=Wt.SERVER_ERROR;if(t instanceof w.AppError)switch(t.error[".tag"]){case"src_file_not_found":i="src_file_not_found",o=Wt.srcFilesNotFound(e.length);break;case"src_file_wrong_type":i="src_file_wrong_type",o=Wt.srcFilesWrongType(e.length);break;case"no_write_permission":o=Wt.NO_WRITE_PERMISSION;break;case"other":i="server_error"}if(1===e.length){const t=Xt(e[0]);n.Snackbar$1.failSticky(Wt.singleFileFailSaveMsFile({filename:t,rootCause:o}))}else n.Snackbar$1.failSticky(Wt.multipleFilesFullFailureMsFile(o));return i})(e,a);jt(t.role,e.length,s,i,o,r,l,"failed")}})),ii=["gdoc","gslides","gsheet"],oi=(e,t)=>(i,o)=>!t.some((e=>e(i,o)))&&e(i,o),ni=o.multiFileWithExtensionSelector(["gdoc"]),si=o.multiFileWithExtensionSelector(["gslides"]),ri=o.multiFileWithExtensionSelector(["gsheet"]),ai=oi(o.multiFileWithExtensionSelector(ii),[ni,si,ri]),li=o.multiFileWithExtensionSelector(["gdoc","doc","docx"]),ci=o.multiFileWithExtensionSelector(["gslides","ppt","pptx"]),di=o.multiFileWithExtensionSelector(["gsheet","xls","xlsx"]),ui=oi(o.multiFileWithExtensionSelector(ii.concat(["doc","docx","ppt","pptx","xls","xlsx"])),[li,ci,di]);var _i;!function(e){e.GOOGLE_DOC_SHORTCUT=r.intl.formatMessage({id:"CKb8d4",defaultMessage:"Google Doc shortcut"}),e.GOOGLE_SLIDES_SHORTCUT=r.intl.formatMessage({id:"f6BDMy",defaultMessage:"Google Slides shortcut"}),e.GOOGLE_SHEET_SHORTCUT=r.intl.formatMessage({id:"4dVxeR",defaultMessage:"Google Sheet shortcut"}),e.GOOGLE_FILE_SHORTCUT=r.intl.formatMessage({id:"c4laUx",defaultMessage:"Google file shortcut"}),e.MICROSOFT_DOC=r.intl.formatMessage({id:"yUBw4G",defaultMessage:"Microsoft Word"}),e.MICROSOFT_SLIDES=r.intl.formatMessage({id:"F/PKmQ",defaultMessage:"Microsoft Powerpoint"}),e.MICROSOFT_SHEET=r.intl.formatMessage({id:"wxiHoJ",defaultMessage:"Microsoft Excel"}),e.MICROSOFT_FILE=r.intl.formatMessage({id:"zNrz5l",defaultMessage:"Microsoft file"})}(_i||(_i={}));const fi=(e,t)=>a.__awaiter(void 0,void 0,void 0,(function*(){yield((e,t)=>a.__awaiter(void 0,void 0,void 0,(function*(){const i=yield $t(t);i&&Qt({user:t,srcFileNames:e.map((e=>{var t;return null!==(t=Xt(e))&&void 0!==t?t:""})),targetDest:Ht.GOOGLE_DRIVE,copyPermissionsSetting:i.copy_permissions_to_google_shortcut,onUpdateCopyPermissionsSetting:({dontAskMeAgain:e,copyFilePermissions:i})=>{qt({user:t,dontAskMeAgain:e,copyFilePermissions:i})},onSubmit:({modalWasShown:i,copyFilePermissions:o,folderId:n})=>{Zt({files:e,user:t,modalWasShown:i,copyFilePermissions:o,folderId:n})}})})))(e,t)})),gi=(e,t)=>a.__awaiter(void 0,void 0,void 0,(function*(){yield((e,t)=>a.__awaiter(void 0,void 0,void 0,(function*(){const i=yield $t(t);i&&Qt({user:t,srcFileNames:e.map((e=>{var t;return null!==(t=Xt(e))&&void 0!==t?t:""})),targetDest:Ht.MICROSOFT_FILE,copyPermissionsSetting:i.copy_permissions_to_google_shortcut,onUpdateCopyPermissionsSetting:({dontAskMeAgain:e,copyFilePermissions:i})=>{qt({user:t,dontAskMeAgain:e,copyFilePermissions:i})},onSubmit:({modalWasShown:i,copyFilePermissions:o})=>{ti({files:e,user:t,modalWasShown:i,copyFilePermissions:o})}})})))(e,t)})),pi=e=>{var{shortcutUrl:t}=e,i=a.__rest(e,["shortcutUrl"]);const o=T.urlToShortcutIconAsset(t,"small");return pt.default.createElement("img",Object.assign({},i,{src:o,alt:""}))};pi.displayName="ShortcutsIcon";function hi(e){switch(e){case 360:return{".tag":"res_360_p"};case 720:return{".tag":"res_720_p"};case 1080:return{".tag":"res_1080_p"};case 1440:return{".tag":"res_1440_p"};case 2160:return{".tag":"res_2160_p"};default:return{".tag":"unknown_res"}}}const Si=[Mt,Ft,...At,...Ct,...kt,...Pt,...Lt,...[...[{actionText:_i.GOOGLE_DOC_SHORTCUT,actionIcon:e=>pt.default.createElement(pi,Object.assign({},e,{shortcutUrl:"docs.google.com/document"})),selector:li,convert:fi,actionGroup:xt.CLOUD_DOCS},{actionText:_i.GOOGLE_SLIDES_SHORTCUT,actionIcon:e=>pt.default.createElement(pi,Object.assign({},e,{shortcutUrl:"docs.google.com/presentation"})),selector:ci,convert:fi,actionGroup:xt.CLOUD_DOCS},{actionText:_i.GOOGLE_SHEET_SHORTCUT,actionIcon:e=>pt.default.createElement(pi,Object.assign({},e,{shortcutUrl:"docs.google.com/spreadsheets"})),selector:di,convert:fi,actionGroup:xt.CLOUD_DOCS},{actionText:_i.GOOGLE_FILE_SHORTCUT,actionIcon:e=>pt.default.createElement(pi,Object.assign({},e,{shortcutUrl:"www.google.com"})),selector:ui,convert:fi,actionGroup:xt.CLOUD_DOCS}],...[{actionText:_i.MICROSOFT_DOC,actionIcon:e=>pt.default.createElement(Gt,Object.assign({},e,{width:14,height:14,name:"microsoft_docx"})),selector:ni,convert:gi,actionGroup:xt.CLOUD_DOCS},{actionText:_i.MICROSOFT_SLIDES,actionIcon:e=>pt.default.createElement(Gt,Object.assign({},e,{width:14,height:14,name:"microsoft_pptx"})),selector:si,convert:gi,actionGroup:xt.CLOUD_DOCS},{actionText:_i.MICROSOFT_SHEET,actionIcon:e=>pt.default.createElement(Gt,Object.assign({},e,{width:14,height:14,name:"microsoft_xlsx"})),selector:ri,convert:gi,actionGroup:xt.CLOUD_DOCS},{actionText:_i.MICROSOFT_FILE,actionIcon:p.FileLine,selector:ai,convert:gi,actionGroup:xt.CLOUD_DOCS}]],...g.SUPPORTED_SCALE_RESOLUTIONS.map((e=>({actionText:`MP4 ${e}P`,actionIcon:h.VideoLine,selector:o.singleFileWithExtensionAndResolutionSelector(g.SUPPORTED_SEGMENT_CONCAT_EXTENSIONS,e),convert:(t,i,o)=>{const{source:n}=o,s={sequence:[{workflow_action:{".tag":"video_scale",scale:hi(e)}}]};return c.updateSnackbar({variant:"sync",title:"Loading"}),l.convertSingleFileAsynchronously(t[0],s,n)},actionGroup:xt.VIDEO_SCALE})))];function vi({getActiveFile:e,user:t},i){const{file:s,sharedLinkInfo:r,sharePermission:a}=e();return o.canConvertFile(s,a)&&n.canDownloadFile(r,a)?((e,t,i)=>Si.filter((o=>o.selector(e,t,i))))([s],{},i):[]}const mi=e=>{const{conversionActions:t,file:i}=e,o=t.filter((e=>e.actionGroup===xt.VIDEO_SCALE)),n=t.filter((e=>e.actionGroup!==xt.VIDEO_SCALE)),s=n.length>0?Ei(n,i,e):null,r=o.length>0?Ei(o,i,e):null;return pt.default.createElement(pt.default.Fragment,null,s,r)},Ei=(e,t,i)=>pt.default.createElement(n.Menu.Segment,null,e.map((e=>{const s=t.bytes/Math.pow(1024,2),a=A.getConversionFileSizeLimitMB([n.file_extension(n.getFilename(t))],e.actionText),l=s>a,c=r.intl.formatMessage({id:"0vePbC",defaultMessage:"File is larger than the {fileSizeLimitMB}MB limit"},{fileSizeLimitMB:a}),d=pt.default.createElement(n.Menu.ActionItem,{key:e.actionText,disabled:l,value:{handler:()=>(({file:e,user:t,action:i,encryptionOptions:s,logUserAction:r,context:a,shareToken:l,actionSurface:c="",sharedLinkInfo:d})=>{if(r(n.UserAction.SelectSaveAs,a,{conversion_type:i.actionText,actionSurface:c}),t)i.convert([e],t,{shareToken:l,source:"preview"});else{const t=new URL(window.location.href);t.searchParams.set("save_as","true"),t.searchParams.set("save_as_action",i.actionText),window.history.replaceState(t.href,"",t.href),o.showAuthModal({mode:n.AuthMode.REGISTER,sharedLinkUrl:t.href,kind:n.LoginOrRegisterKind.POSTSAVEAS,encryptionOptions:s,loggingExtra:{signup_source:"save_as"},signupTag:n.RegistrationSource.SHMODEL_SAVE_AS_REGISTER,webSignInTag:n.getWebSignInTag(!1,e.is_dir),authDialogPreviousElement:n.AuthDialogPreviousElementTag.SAVE_AS,sharedLinkInfo:d})}})(Object.assign(Object.assign({},i),{action:e}))},withLeftAccessory:pt.default.createElement(n.UIIcon,{src:e.actionIcon,width:"20px",height:"20px"})},e.actionText);return l?pt.default.createElement(n.Tooltip,{key:e.actionText,title:c,placement:"left",id:"flows-disabled-menu-item-tooltip"},pt.default.createElement("div",null,d)):d}))),Ii=[n.SDKPreviewSurface.BROWSE,n.SDKPreviewSurface.FILE_LOCKING,n.SDKPreviewSurface.HELLOSIGN,n.SDKPreviewSurface.HOME,n.SDKPreviewSurface.INBAND_SHARE,n.SDKPreviewSurface.PHOTOS,n.SDKPreviewSurface.RECENTS,n.SDKPreviewSurface.SEARCH,n.SDKPreviewSurface.SHARED_CONTENT_LINK,n.SDKPreviewSurface.SHARED_LINK,n.SDKPreviewSurface.STANDALONE_PREVIEW,n.SDKPreviewSurface.STARRED,n.SDKPreviewSurface.VIDEO_HOME,n.SDKPreviewSurface.FSS_DESKTOP_PREVIEW],wi={filterValidFile:e=>!e||n.isInsideSharedFolder(e)||n.isEncryptedFile(e)?void 0:e,filterValidUser:e=>({user:e}),shouldShowForPreviewSurface:o.filterSurfaceIn(Ii),shouldShowForPreviewType:o.alwaysShow},Mi=o.withActionCondition(wi,((e,t,i,s,r)=>{const a=vi({getActiveFile:i,user:e.user},s);if(a.length)return{label:o.FILE_CONVERSION_STRING,userAction:n.UserAction.OpenSaveAs,disabled:{disabled:!1},icon:p.ConvertFileLine,action:{type:"menu",menu:pt.default.createElement(mi,{context:n.UserActionContext.FileMenu,conversionActions:a,encryptionOptions:r,file:e.file,logUserAction:t.logUserAction,user:e.user,sharedLinkInfo:i().sharedLinkInfo})}}}),void 0),Fi=e=>({userAction:void 0,disabled:{disabled:!1},action:{type:"click",handler:()=>a.__awaiter(void 0,void 0,void 0,(function*(){return e()}))},label:o.INFO_ACTION_STRING,accessibleLabel:o.INFO_ACCESSIBILITY_STRING,icon:n.InfoLine}),Oi=Object.assign(Object.assign({},o.fileActionCondition),{filterValidFile:e=>{const t=o.fileActionCondition.filterValidFile(e);return!t||o.isInsideVaultFolder(t)||o.isPnmSuppressMoveSelected(t)?void 0:t}}),Ti=o.withActionCondition(Oi,((t,i,r,a,l,c)=>({label:o.MOVE_ACTION_STRING,icon:s.MoveLine,userAction:n.UserAction.Move,disabled:t.file.read_only?{disabled:!0,tooltipMessage:o.ACTION_DISABLED_STRING}:{disabled:!1},action:{type:"click",handler:()=>new Promise((function(t,i){e(["./c_action_plugins_move_action_action"],t,i)})).then((({moveActionWrapper:e})=>e({file:t.file,user:t.user,previewType:i,previewSurface:r,onFileChanged:a,browseContext:l,browseExceptions:c})))}})),void 0),Ai=[n.PreviewType.SsrDoc,n.PreviewType.CloudDoc,n.PreviewType.Image,n.PreviewType.HTML,n.PreviewType.Excel],Di={shouldShowForPreviewSurface:o.alwaysShow,shouldShowForPreviewType:o.filterPreviewTypeIn(Ai),filterValidUser:e=>({user:e}),filterValidFile:(e,t,i)=>i||n.isEncryptedFile(e)?void 0:e},Ci=o.withActionCondition(Di,((e,t)=>({label:o.PRINT_ACTION_STRING,userAction:n.UserAction.Print,disabled:{disabled:!1},action:{type:"click",handler:()=>a.__awaiter(void 0,void 0,void 0,(function*(){return t()}))},icon:p.PrintLine})),void 0),bi=o.withActionCondition(o.renameActionConditions,((e,t,i)=>({label:o.RENAME_ACTION_STRING,icon:s.CursorLine,userAction:n.UserAction.Rename,action:{type:"click",handler:()=>a.__awaiter(void 0,void 0,void 0,(function*(){t(n.UserAction.RenameStart,n.UserActionContext.FileMenu),i(!0)}))},disabled:{disabled:!1}})),void 0),yi=[n.SDKPreviewSurface.BROWSE,n.SDKPreviewSurface.FILE_LOCKING,n.SDKPreviewSurface.HELLOSIGN,n.SDKPreviewSurface.HOME,n.SDKPreviewSurface.INBAND_SHARE,n.SDKPreviewSurface.PHOTOS,n.SDKPreviewSurface.RECENTS,n.SDKPreviewSurface.SEARCH,n.SDKPreviewSurface.SHARED_CONTENT_LINK,n.SDKPreviewSurface.SHARED_LINK,n.SDKPreviewSurface.STANDALONE_PREVIEW,n.SDKPreviewSurface.STARRED,n.SDKPreviewSurface.VIDEO_HOME],Pi={filterValidFile:e=>o.isStarringEnabled(e)?e:void 0,filterValidUser:o.filterLoggedInUser,shouldShowForPreviewSurface:o.filterSurfaceIn(yi),shouldShowForPreviewType:o.alwaysShow},Li=o.withActionCondition(Pi,((e,t,i,o,s)=>({label:o,icon:i,userAction:t?n.UserAction.Unstar:n.UserAction.Star,action:{type:"click",handler:()=>a.__awaiter(void 0,void 0,void 0,(function*(){return s()}))},disabled:{disabled:!1}})),void 0),Ri=n.defineMessage({id:"pB6h1Y",defaultMessage:"Archive files over 512 MB cannot be extracted"}),Ni=o.withActionCondition(o.unzipActionConditions,((t,i)=>{const o=t.file.bytes/1048576;return{label:l.UNZIP_ACTION_MESSAGE,icon:l.UnzipAction.actionIcon,disabled:o>=y.UNZIP_MAX_FILESIZE_MB?{disabled:!0,tooltipMessage:Ri}:{disabled:!1},userAction:n.UserAction.Unzip,action:{type:"click",handler:()=>new Promise((function(t,i){e(["./c_action_plugins_unzip_action_action"],t,i)})).then((({unzipAction:e})=>e({user:t.user,file:t.file,shareToken:i})))}}}),void 0),ki=[n.SDKPreviewSurface.BROWSE,n.SDKPreviewSurface.BACKUP,n.SDKPreviewSurface.FILE_LOCKING,n.SDKPreviewSurface.HELLOSIGN,n.SDKPreviewSurface.HOME,n.SDKPreviewSurface.INBAND_SHARE,n.SDKPreviewSurface.PHOTOS,n.SDKPreviewSurface.RECENTS,n.SDKPreviewSurface.SEARCH,n.SDKPreviewSurface.SHARED_CONTENT_LINK,n.SDKPreviewSurface.SHARED_LINK,n.SDKPreviewSurface.STANDALONE_PREVIEW,n.SDKPreviewSurface.STARRED,n.SDKPreviewSurface.VIDEO_HOME,n.SDKPreviewSurface.VIDEO_SYNTHESIS],xi={filterValidFile:e=>function(e){const t=o.fileActionCondition.filterValidFile(e);return!!t&&!P.isCloudBasedDoc(t)&&!M.isPointerByExtension(t.fq_path)}(e)?e:void 0,filterValidUser:o.filterLoggedInUser,shouldShowForPreviewSurface:o.filterSurfaceIn(ki),shouldShowForPreviewType:o.alwaysShow};const Ui=o.withActionCondition(xi,(t=>({label:o.VERSION_HISTORY_ACTION_STRING,icon:n.ClockLine,userAction:n.UserAction.VersionHistory,disabled:{disabled:!1},action:{type:"click",handler:()=>new Promise((function(t,i){e(["./c_action_plugins_version_history_action_action"],t,i)})).then((({versionHistoryActionWrapper:e})=>e(t.file,t.user)))}})),void 0),Gi={filterValidFile:(e,t,i,o)=>o?e:void 0,filterValidUser:e=>({user:e}),shouldShowForPreviewSurface:e=>e===n.SDKPreviewSurface.VERSION_HISTORY,shouldShowForPreviewType:o.alwaysShow},Hi=o.withActionCondition(Gi,((e,t)=>{if(t)return{label:o.RESTORE_ACTION_STRING,icon:p.RewindLine,userAction:n.UserAction.Restore,disabled:{disabled:!1},action:{type:"click",handler:()=>a.__awaiter(void 0,void 0,void 0,(function*(){return t()}))}}}),void 0);t.default=({contentProps:e})=>{var t,i;const{previewSurface:s,pluginArgs:r,fileConfig:a,hasOpenInActions:l}=o.usePluginMigrationContext(),{fileViewerId:c,pluginContext:d,logUserAction:u}=y.useFileViewerContext(),_=o.useFileViewerSelector(o.getCurrentPreviewKey,c),f=null!==(t=o.useCurrentPreviewMetadata().previewType)&&void 0!==t?t:n.PreviewType.Loading,g=r.getActiveFile().file,p=r.getActiveFile().sharePermission,h=r.user,S=o.useRootFile(),{data:v}=o.useFileContentMetadataQueryFromPlugins(S),m=null===(i=null==v?void 0:v.apiData)||void 0===i?void 0:i.metadata,{onFileChanged:E,browseContext:I,browseExceptions:w,canRestoreRevision:M,getActiveFile:F,shareToken:O,encryptionOptions:T,authModalKind:A,onRestoreRevision:P}=r,R=pt.useMemo((()=>({file:g,user:h,previewSurface:s,previewType:f,sharePermission:p,previewKey:_,canRestoreRevision:M})),[g,M,_,s,f,p,h]),N=((e,t)=>{const i=D.getStoreForStarred(),{isStarred:o,message:n,iconSrc:s,handleClick:r}=b.useStarControlWithStore({getActiveFile:t,user:e.user,starredStore:i});return pt.default.useMemo((()=>Li(e,o,s,n,r)),[e,r,s,o,n])})(R,F),k=((e,t)=>{const{onPrint:i}=o.usePreviewControls(),n=o.useCurrentPreviewMetadata(),s=o.usePrintCallback(),r=o.useStabilizedCallback((()=>{null==i||i(),s()})),a=!o.getCloudDocExitUrl(n)&&t.enable_print;return pt.default.useMemo((()=>a?Ci(e,r):void 0),[e,r,a])})(R,a),x=o.useFileActivityAction(R),U=(()=>{const e=o.useSetLeftSidebarCallback(D.INFO_BLADE_PLUGIN_ID,n.UserActionContext.FileMenu);return pt.default.useMemo((()=>Fi(e)),[e])})(),G=o.useToggleRenameStateCallback(),H=o.useSetDeleteFileModalOpenCallback(),V=pt.useMemo((()=>[[Ti(R,f,s,E,I,w),St(R,f,I,w),mt(R,u,H,s,E),bi(R,u,G)],[N],[U,Ui(R),x],[C.makeOpenInAction(R,!!l),Mi(R,d,F,m,T),Ni(R,O),...o.makeDownloadActions(R,F,d,m,s,O,p,T,A,null==S?void 0:S.name),Hi(R,P)],[k]]),[A,null==S?void 0:S.name,I,w,R,d,T,x,m,F,l,U,E,P,s,f,k,p,O,N]),z=pt.useCallback((e=>u(e,n.UserActionContext.FileMenu)),[u]);return pt.createElement(L.TitlebarMenuContent,{options:V,elementId:"file-menu",contentProps:e,logAction:z})}}));
//# sourceMappingURL=c_title_bar_dropdowns_titlebar_file_dropdown.js-vflCcXZ1u.map
