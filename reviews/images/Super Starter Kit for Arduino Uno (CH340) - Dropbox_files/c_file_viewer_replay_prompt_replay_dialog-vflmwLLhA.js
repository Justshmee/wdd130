define(["exports","./c_init_data_runtime","react","./e_folder_viewer_src_main","./c_core_i18n","./c_esm_misc_util","./c_campaigns_campaign_events_api","./c_lodash-es_lodash","./c_react_query_helpers_helpers","./c_api_v2_client_base","./c_core_uri","./c_core_attribution_header","./c_csrf","metaserver/static/js/modules/constants/viewer","./e_edison","./c_apex-metrics_src_types","./c_init_data_edison","./c_src_sink_index","./e_core_exception","./c_core_xhr","./c_api_v2_noauth_client","./c_core_notify","react-dom","metaserver/static/js/modules/constants/web_experience_constants","metaserver/static/js/modules/constants/sharing","metaserver/static/js/modules/constants/locales","metaserver/static/js/modules/constants/file_viewer_configuration","metaserver/static/js/modules/constants/file_viewer_feature_experiments","metaserver/static/js/modules/constants/time","metaserver/static/js/modules/constants/login_and_register","metaserver/static/js/modules/constants/fingerprintjs_constants","./c_security_crypto","metaserver/static/js/langpack"],(function(e,t,a,i,s,r,n,o,l,c,d,p,_,m,g,u,f,v,y,x,b,E,w,M,h,k,j,C,D,R,N,F,O){"use strict";function A(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(a){if("default"!==a){var i=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(t,a,i.get?i:{enumerable:!0,get:function(){return e[a]}})}})),t.default=e,Object.freeze(t)}var B=A(a);i.injectInternalStyle("/static/metaserver/static/js/file_viewer/replay_prompt/upsell_dialog.module.out-vflg32xGV.css",(e=>"._upsell-dialog-container_4y0ag_6{bottom:0;padding:var(--dig-spacing__macro__small);position:absolute;right:0}._upsell-dialog_4y0ag_6{background:var(--color__faint__background);border:1px solid var(--color__standard__border);border-radius:20px;box-sizing:border-box;max-width:360px;padding:var(--dig-spacing__macro__medium);width:100%}._upsell-secondary-button_4y0ag_22{margin-left:var(--dig-spacing__micro__large)}._upsell-footer_4y0ag_26{align-items:center;display:flex;flex-direction:row;justify-content:start;margin-top:var(--dig-spacing__macro__small)}"));const I=({acceptText:e,declineText:t,titleText:s,bodyContent:r,afterAccept:n,afterDecline:o,uxaPrefix:l,redirectUrl:c,acceptLinkProps:d={},"data-testid":p})=>{const[_,m]=a.useState(!1),g=a.useRef(!0);B.useEffect((()=>(g.current=!0,()=>{g.current=!1})));return _?null:B.createElement("div",{className:"_upsell-dialog-container_4y0ag_6","data-testid":p},B.createElement("div",{className:"_upsell-dialog_4y0ag_6"},B.createElement(i.Title,{size:"standard",isBold:!0},s),r,B.createElement("div",{className:"_upsell-footer_4y0ag_26"},B.createElement(i.Button,Object.assign({inverse:!0,variant:"filled",href:c,onClick:()=>n(m),"data-uxa-log":`${l}-upsell-dialog-continue`},d),e),B.createElement("div",{className:"_upsell-secondary-button_4y0ag_22"},B.createElement(i.Button,{variant:"transparent",onClick:()=>{m(!0),o&&o()},"data-uxa-log":`${l}-upsell-dialog-dismiss`},t)))))};I.displayName="UpsellDialog";const T=e=>new i.DefaultUserApiV2Client(e);function P(e,a,s){return t.__awaiter(this,void 0,void 0,(function*(){e&&(yield r.GetReelRoutes(T(e)).rpc("log_replay_preview_entry_point_action",{entrypoint_action:{".tag":a}},{})),i.UserActivityLogger.log("web","replay-fvsdk-dialog-"+a,{variant:s})}))}const $=({user:e,file:a})=>{const[o,l]=B.useState(!1),[c,d]=B.useState(void 0),p=window.location.href;B.useEffect((()=>{t.__awaiter(void 0,void 0,void 0,(function*(){var s,o;if(e&&a&&i.isBrowseFile(a)){const c=null===(s=i.ExtensionCategories[i.getExtension$1(a)])||void 0===s?void 0:s.toLowerCase();if("video"!==c&&"audio"!==c&&"image"!==c)return;const p=yield function(e,a){return t.__awaiter(this,void 0,void 0,(function*(){return yield r.GetReelRoutes(T(e)).rpc("get_replay_preview_entry_point_eligibility",{media_type:{".tag":a}},{})}))}(e,c);l(!!p.show_entrypoint&&p.show_entrypoint),(null===(o=p.campaign_context)||void 0===o?void 0:o.campaign_impression_id)&&d(n.createMegaphoneCampaignImpressionContext(p.campaign_context.campaign_impression_id,p.campaign_context.campaign_id?`${p.campaign_context.campaign_id}`:void 0,p.campaign_context.campaign_variant_id?`${p.campaign_context.campaign_variant_id}`:void 0))}}))}),[]),B.useEffect((()=>{e&&o&&(P(e,"impression",0),c&&n.logCampaignImpression(c))}),[o]),B.useEffect((()=>{(p.includes("/s/")||p.includes("/sh/")||p.includes("/scl/")||p.includes("/spri/"))&&l(!1)}),[p]);const _=a?`https://replay.dropbox.com/project/creating/${a.file_id}?creationSource=dropbox_previews_prompt`:"https://replay.dropbox.com/?login=true";return o?B.createElement(I,{afterAccept:()=>{e&&P(e,"acknowledgement",0),c&&n.logCampaignClick(c)},afterDecline:()=>{e&&P(e,"dismissal",0),c&&n.logCampaignDismissed(c)},uxaPrefix:"replay-fvsdk-prompt",titleText:o?a&&i.isBrowseFile(a)&&"IMAGE"===i.ExtensionCategories[i.getExtension$1(a)]?s.intl.formatMessage({id:"fJp3JL",defaultMessage:"Fast-track image approvals with Dropbox Replay"}):a&&i.isBrowseFile(a)&&"AUDIO"===i.ExtensionCategories[i.getExtension$1(a)]?s.intl.formatMessage({id:"ValGuy",defaultMessage:"Fast-track audio approvals with Dropbox Replay"}):s.intl.formatMessage({id:"qQoYME",defaultMessage:"Fast-track video approvals with Dropbox Replay"}):a&&i.isBrowseFile(a)&&"IMAGE"===i.ExtensionCategories[i.getExtension$1(a)]?s.intl.formatMessage({id:"fJp3JL",defaultMessage:"Fast-track image approvals with Dropbox Replay"}):a&&i.isBrowseFile(a)&&"AUDIO"===i.ExtensionCategories[i.getExtension$1(a)]?s.intl.formatMessage({id:"ValGuy",defaultMessage:"Fast-track audio approvals with Dropbox Replay"}):s.intl.formatMessage({id:"Svd0z9",defaultMessage:"Fast-track feedback with Dropbox Replay."}),bodyContent:o?B.createElement(B.Fragment,null,B.createElement(i.Text,{className:"replay-dialog-subtext",tagName:"p",isBold:!0},s.intl.formatMessage({id:"0RFIO+",defaultMessage:"Speed up the review and approval process for video, image, and audio files."})),B.createElement(i.Text,{className:"replay-dialog-subtext",tagName:"div"},B.createElement("ul",{className:"replay-dialog-list",style:{paddingInlineStart:"20px"}},B.createElement("li",null,s.intl.formatMessage({id:"qOrqAu",defaultMessage:"Provide frame-accurate comments and markups"})),B.createElement("li",null,s.intl.formatMessage({id:"501bEW",defaultMessage:"Connect the feedback you receive with your video editing tools including Adobe Premiere Pro, Blackmagic Design DaVinci Resolve, and more."})),B.createElement("li",null,s.intl.formatMessage({id:"xQjeY3",defaultMessage:"Review videos in a real-time virtual viewing room"}))))):B.createElement(B.Fragment,null,B.createElement(i.Text,{className:"replay-dialog-subtext",tagName:"p",isBold:!0},s.intl.formatMessage({id:"Wj4Gtx",defaultMessage:"Optimize your approval process and:"})),B.createElement(i.Text,{className:"replay-dialog-subtext",tagName:"div"},B.createElement("ul",{className:"replay-dialog-list",style:{paddingInlineStart:"20px"}},B.createElement("li",null,s.intl.formatMessage({id:"UnCNrR",defaultMessage:"Collect comments in one place."})),B.createElement("li",null,s.intl.formatMessage({id:"CE/I0u",defaultMessage:"Mark up individual video frames."})),B.createElement("li",null,s.intl.formatMessage({id:"tid1YH",defaultMessage:"Host a live review of your video."})),B.createElement("li",null,s.intl.formatMessage({id:"prvJus",defaultMessage:"Connect third-party creative tools like Adobe Premiere Pro, Da Vinci Resolve, and more."}))))),acceptText:s.intl.formatMessage({id:"RGcvfk",defaultMessage:"Get started"}),declineText:s.intl.formatMessage({id:"t97mKK",defaultMessage:"Not now"}),redirectUrl:_}):null};$.displayName="ReplayDialog",e.ReplayDialog=$}));
//# sourceMappingURL=c_file_viewer_replay_prompt_replay_dialog.js-vflExnDZU.map
